{{ define "main" }}
<!-- 公告通知 -->
<div id="announcement" 
    class="fixed top-20 right-4 w-80 p-4 rounded-lg border border-border/40 bg-card/95 backdrop-blur
    shadow-lg shadow-accent/5 z-50 transform translate-x-[120%] transition-transform duration-500
    animate-fade opacity-0">
    <div class="flex items-start justify-between gap-3">
        <div class="flex items-center gap-2 text-sm font-medium mb-1">
            <div class="i-carbon-notification w-4 h-4 text-primary/80"></div>
            <span>{{ with .Site.GetPage "announcement" }}{{ .Title }}{{ end }}</span>
        </div>
        <button onclick="closeAnnouncement()" class="text-muted-foreground/60 hover:text-muted-foreground">
            <div class="i-carbon-close w-4 h-4"></div>
        </button>
    </div>
    <div class="text-sm text-muted-foreground/70 prose-sm prose-p:my-0">
        {{ with .Site.GetPage "announcement" }}{{ .Content }}{{ end }}
    </div>
</div>

<section class="h-screen flex items-center">
    <div class="container max-w-6xl mx-auto px-4">
        <main class="flex items-center justify-between gap-24">
            <div class="flex-1 max-w-xl space-y-6">
                <h2 class="text-4xl font-bold">
                    <span class="inline-flex overflow-hidden">
                        <span class="animate-text-reveal" style="--index: 0">H</span>
                        <span class="animate-text-reveal" style="--index: 1">i</span>
                        <span class="animate-text-reveal" style="--index: 2">,</span>
                        <span class="animate-text-reveal" style="--index: 3">&nbsp;</span>
                        <span class="animate-text-reveal" style="--index: 4">I</span>
                        <span class="animate-text-reveal" style="--index: 5">'</span>
                        <span class="animate-text-reveal" style="--index: 6">m</span>
                        <span class="animate-text-reveal" style="--index: 7">&nbsp;</span>
                        {{ $author := .Site.Params.author }}
                        {{ $chars := split $author "" }}
                        {{ range $index, $char := $chars }}
                        <span class="animate-text-reveal" style="--index: {{ add 8 $index }}">{{ $char }}</span>
                        {{ end }}
                        <span class="animate-text-reveal" style="--index: {{ add 8 (len $chars) }}">&nbsp;</span>
                        <span class="animate-text-reveal" style="--index: {{ add 9 (len $chars) }}">👋</span>
                    </span>
                </h2>
                <div class="flex flex-wrap gap-2">
                    {{ range $index, $tag := .Site.Params.tags }}
                    <span class="px-3 py-1 rounded-full bg-accent/50 text-sm text-muted-foreground/80
                        animate-fade-up opacity-0" style="animation-delay: {{ add 0.5 (mul $index 0.1) }}s">
                        {{ $tag }}
                    </span>
                    {{ end }}
                </div>
                {{ with .Site.Params.bio }}
                <p class="text-lg text-muted-foreground/70 animate-fade-up opacity-0" 
                    style="animation-delay: 0.8s">
                    {{ . }}
                </p>
                {{ end }}

                <div class="flex gap-4 animate-fade-up opacity-0" style="animation-delay: 0.8s; animation-fill-mode: forwards;">
                    <a href="#" title="Twitter" class="hover:opacity-80 text-white p-3 rounded-full"
                        style="background-color: #1DA1F2">
                        <div class="i-carbon-logo-twitter w-5 h-5"></div>
                    </a>
                    <a href="#" title="GitHub" class="hover:opacity-80 text-white p-3 rounded-full"
                        style="background-color: #181717">
                        <div class="i-carbon-logo-github w-5 h-5"></div>
                    </a>
                    <a href="#" title="RSS" class="hover:opacity-80 text-white p-3 rounded-full"
                        style="background-color: #EE802F">
                        <div class="i-carbon-rss w-5 h-5"></div>
                    </a>
                    <a href="#" title="Email" class="hover:opacity-80 text-white p-3 rounded-full"
                        style="background-color: #EA4335">
                        <div class="i-carbon-email w-5 h-5"></div>
                    </a>
                </div>
            </div>

            <div class="w-64 h-64 rounded-full overflow-hidden flex-shrink-0 border-2 border-background shadow-xl animate-fade-left opacity-0" style="animation-delay: 0.6s; animation-fill-mode: forwards;">
                <img src="/img/avatar.jpg" alt="avatar" class="object-cover rounded-full" width="256" height="256"
                    loading="lazy">
            </div>
        </main>
    </div>
</section>

<section class="bg-accent/20">
    <div class="container max-w-6xl mx-auto px-4 py-20">
        <div class="flex items-center justify-between mb-8">
            <h2 class="text-2xl font-medium text-foreground/80">最新文章</h2>
            {{/*  <a href="/posts" class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring h-9 px-4 py-2 bg-primary text-primary-foreground shadow hover:bg-primary/90">
                查看全部
                <div class="i-carbon-arrow-right ml-2 w-4 h-4"></div>
            </a>  */}}
        </div>
        <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
            {{ $posts := where .Site.RegularPages "Section" "posts" }}
            {{ $featuredPosts := where $posts "Params.featured" true }}
            {{ $recentPosts := $posts | first 3 }}
            {{ $displayPosts := union $featuredPosts $recentPosts | first 3 }}
            
            {{ range $index, $post := $displayPosts }}
            {{ partial "post-card.html" (dict "context" . "post" $post "index" $index) }}
            {{ end }}
        </div>
    </div>
</section>

<footer class="bg-background">
</footer>

<script>
let isAnnouncementVisible = false;

function showAnnouncement() {
    const announcement = document.getElementById('announcement');
    if (announcement) {
        announcement.classList.remove('translate-x-[120%]');
        announcement.classList.remove('opacity-0');
        isAnnouncementVisible = true;
    }
}

function closeAnnouncement() {
    const announcement = document.getElementById('announcement');
    if (announcement) {
        announcement.classList.add('translate-x-[120%]');
        announcement.classList.add('opacity-0');
        isAnnouncementVisible = false;
    }
}

function toggleAnnouncement() {
    if (isAnnouncementVisible) {
        closeAnnouncement();
    } else {
        showAnnouncement();
    }
}

// 监听键盘事件 - 使用 Ctrl/Cmd + / 切换公告显示
document.addEventListener('keydown', function(e) {
    if ((e.ctrlKey || e.metaKey) && e.key === '/') {
        e.preventDefault();
        toggleAnnouncement();
    }
});

// 页面加载完成后初始化
document.addEventListener('DOMContentLoaded', function() {
    // 延迟2秒后自动显示一次
    setTimeout(showAnnouncement, 2000);
});
</script>
{{ end }}